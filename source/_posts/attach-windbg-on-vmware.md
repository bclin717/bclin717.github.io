---
title: 如何用WinDBG掛VMware 
categories:
  - 軟體研討
date: 2020-05-17 15:07:58
tags:
excerpt: 
---

# Steps

1. Install a Windows System in VMWare
2. Delete the Printer and add a new Serial Port
  ![](https://i.imgur.com/Ir7IidC.jpg)
3. Add a shortcut of WinDBG.
- Edit the target to C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\windbg.exe" -k com:port=\.\pipe\com_1,baud=115200,pipe
- Run as Administrator
4. Open GuestOS in VMWare, open CMD as Administrator
- The {ID} is generated by second command
  - bcdedit /dbgsettings serial baudrate:115200 debugport:1
  - bcdedit /copy {current} /d DebugEntry
  - bcdedit /displayorder {current} {ID}
  - bbcdedit /debug {ID} ON
5. Restart the virtual machine and choose the DebugEntry.
6. Run the WinDBG in the starting process of virtual machine.
